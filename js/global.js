(function(){var e={_dpr:null,url:{host:"/canudiloAu/",login:"login.ca?type=login"},user:{name:"",lotteryResult:null},setUserInfo:function(e){for(var t in e)window.localStorage[t]=e[t]},getUserInfo:function(){return window.localStorage?{username:window.localStorage.username,department:window.localStorage.department,password:window.localStorage.password,mobile:window.localStorage.mobile,awardrank:window.localStorage.awardrank}:{}},stringfObj:function(e){var t=[];for(var n in e)t.push(n+"="+e[n]);return t.join("&")},fitScreen:function(){var e,t,n=$('meta[name="viewport"]')[0];/iPhone/ig.test(window.navigator.userAgent)?e=window.devicePixelRatio||1:e=1,t=1/e,this._dpr=e,n.setAttribute("content","initial-scale="+t+",maximum-scale="+t+", minimum-scale="+t+",user-scalable=no")},fitPage:function(){var e=window.screen.availHeight;/iPhone/ig.test(window.navigator.userAgent)?$("div.page").css("height",e*this._dpr):$("div.page").css("minHeight",600)},loadingMask:{dom:null,render:function(){this.dom=$("<div></div>").appendTo("body"),this.dom.addClass("mask").html('<div class="loading"><div class="double-bounce1"></div> <div class="double-bounce2"></div></div>')},open:function(){(!this.dom||this.dom.length<=0)&&this.render(),this.dom.show()},close:function(){this.dom.hide()}},checkLogin:function(e,t){this.loadingMask.open();var n=this,r=this.getUserInfo();r.awardrank&&delete r.awardrank;var i=this.stringfObj(r);if(i.match(/username|department|password|mobile/g).length<4){t.call();return}$.ajax({url:this.url.host+this.url.login+"&"+i+"&t="+(new Date).getTime(),type:"GET",cache:!1,success:function(r){r=JSON.parse(r),n.loadingMask.close(),r.result==1&&r.data.loginstatus>0?(n.setUserInfo(r.data),e.call()):t.call()},error:function(e){e.statusText=="timeout"?(alert("服务器请求超时无响应，请刷新页面"),document.location.reload()):(alert("服务器发生了意料之外的错误，请稍后重新登录。"),document.location.href="login.html"),n.loadingMask.close()}})}};window.g=e,e.fitScreen(),$.ajaxSetup({timeout:1e4})})(window);